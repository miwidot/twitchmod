TwitchMod Changelog
===================

[2025-11-02 12:08] FEATURE: Complete Persistence System - Login & Channels automatically saved!
-------------------------------------------------------------------------------------------
- ADDED: OAuth token persistence - login only once, stays logged in!
- ADDED: Channel list persistence - all channels saved and restored on restart
- ADDED: IRC NAMES command parsing - user list now populates correctly!
- IMPROVED: TwitchAuth saves/loads token from QSettings automatically
- IMPROVED: ChannelList saves/loads channels on every add/remove
- IMPROVED: Token validation on startup - expired tokens are detected
- FIXED: Users were not showing in user list (NAMES wasn't parsed)
- SECURITY: Tokens stored in QSettings (~/Library/Preferences/TwitchMod.plist on macOS)
- UX: App remembers everything - no need to re-login or re-add channels!
- Storage location: macOS: ~/Library/Preferences/com.TwitchMod.TwitchMod.plist
- Files modified:
  - src/twitch/twitchauth.h/cpp - saveToken(), loadToken(), clearToken()
  - src/channellist.h/cpp - saveChannels(), loadChannels()
  - src/twitch/twitchwebsocket.cpp - IRC 353 NAMES parsing with userJoined signals
  - changelog.txt - This entry
- Token lifetime: Twitch tokens typically valid for 60 days
- Now you can close and reopen the app without losing anything!

[2025-11-02 12:03] CRITICAL FIX: macOS App Launch Deployment - Fixed Qt rpath and code signing!
-------------------------------------------------------------------------------------------
- FIXED: "loading two sets of Qt binaries" crash - removed /opt/homebrew/lib rpath
- FIXED: SIGKILL (Code Signature Invalid) on app launch
- ADDED: QtDBus.framework to bundled frameworks (required by QtGui)
- CHANGED: Executable rpath from /opt/homebrew/lib to @executable_path/../Frameworks
- IMPROVED: Deep code signing of ALL dylibs, frameworks, and plugins
- FIXED: install_name_tool to use bundled Qt frameworks instead of system Qt
- BUILD: Re-ran macdeployqt to ensure all Qt dependencies are bundled
- DEPLOYMENT: App now launches successfully with `open TwitchMod.app`
- Root Cause: CMake was setting rpath to system Qt, causing library conflicts
- Solution: install_name_tool -delete_rpath + install_name_tool -add_rpath
- Files modified:
  - build/TwitchMod.app/Contents/MacOS/TwitchMod - Fixed rpath settings
  - build/TwitchMod.app/Contents/Frameworks/QtDBus.framework - Added missing framework
  - All .dylib, .framework, .so files - Re-signed with ad-hoc signature
  - changelog.txt - This entry
- Build process: cmake → macdeployqt → fix rpath → sign all → codesign --deep
- App now runs standalone without needing system Qt or environment variables!

[2025-11-02 02:44] MAJOR: IRC Chat Implementation - Full Twitch IRC Integration!
-----------------------------------------------------------------------------------
- ADDED: Complete IRC WebSocket connection to wss://irc-ws.chat.twitch.tv:443
- ADDED: IRC authentication with PASS, NICK, and CAP commands
- ADDED: Automatic PING/PONG keepalive handling
- ADDED: JOIN/PART channel functionality
- ADDED: Send messages with PRIVMSG command
- ADDED: IRC message parser for all Twitch IRC commands:
  - PRIVMSG (chat messages)
  - CLEARCHAT (bans/timeouts)
  - CLEARMSG (message deletions)
  - JOIN/PART (user joins/leaves)
  - NAMES (user list)
  - CAP (capabilities)
- IMPROVED: TwitchWebSocket completely rewritten from EventSub to IRC protocol
- ADDED: Auto-join IRC channels when user clicks channel in channel list
- ADDED: Chat message signal integration with MainWindow
- FIXED: Qt 6 deprecation warning (errorOccurred instead of error)
- User Experience: Click channel → Auto-join IRC → See live chat!
- Files modified:
  - src/twitch/twitchwebsocket.h/cpp - Complete IRC protocol implementation
  - src/mainwindow.h/cpp - IRC integration, channel selection handler
  - changelog.txt - This entry
- Now with REAL live Twitch chat via IRC! Messages flow in real-time!

[2025-11-02 02:30] PRODUCTION READY: Hardcoded official Client ID - No setup needed!
-----------------------------------------------------------------------------------
- ADDED: Official TwitchMod Client ID hardcoded in production code
- IMPROVED: Zero configuration for end users - just download and run!
- SIMPLIFIED: Environment variable now optional, only for developers
- CHANGED: getClientId() returns hardcoded ID by default, env var as override
- UPDATED: All documentation to reflect "no setup required" for end users
- PRODUCTION: Client ID: opez5azi81po1xb4hb581ikw3xo04y
- User Experience: Download → Run → Connect → Done! No API keys needed!
- Files modified:
  - src/twitch/twitchauth.cpp - Hardcoded production Client ID
  - README.md - "NO SETUP REQUIRED" for end users
  - SETUP.md - Split into "End Users" (no setup) and "Developers" (optional)
  - changelog.txt - This entry
- Now like Chatterino, Chatty, etc. - works out of the box!

[2025-11-02 02:11] MAJOR: Switched to Device Code Grant Flow (twitch.tv/activate!)
-----------------------------------------------------------------------------------
- CHANGED: Complete OAuth rewrite from Implicit Grant to Device Code Grant Flow
- REMOVED: Local OAuth server (port 8080) completely - no longer needed!
- REMOVED: Browser redirect to localhost - stays on twitch.tv!
- ADDED: User-friendly activation code dialog with clickable link
- ADDED: Automatic polling for authorization (5 second intervals)
- IMPROVED: Much cleaner user experience - just enter code on Twitch website!
- SECURITY: Most secure OAuth flow for public desktop applications
- SIMPLIFIED: No port conflicts, no localhost issues, no redirect problems!
- User Flow: App shows code → User goes to twitch.tv/activate → Enter code → Done!
- Files modified:
  - src/twitch/twitchauth.h/cpp - Complete Device Code Grant implementation
  - src/mainwindow.h/cpp - Added device code dialog with activation instructions
  - SETUP.md - Updated with new twitch.tv/activate flow
  - README.md - Updated quick start guide
  - changelog.txt - This entry
- This is the BEST OAuth flow for desktop apps - recommended by Twitch!

[2025-11-02 01:51] MAJOR: Switched to Implicit Grant OAuth Flow (No Client Secret!)
-----------------------------------------------------------------------------------
- CHANGED: Complete OAuth flow rewrite from Authorization Code to Implicit Grant
- REMOVED: Client Secret requirement completely (following Chatterino's approach)
- CHANGED: OAuth request now uses response_type=token instead of response_type=code
- REMOVED: Token exchange step - access token comes directly from Twitch
- ADDED: JavaScript-based token extraction from URL fragment
- IMPROVED: OAuth callback server now handles implicit grant with JavaScript redirect
- SECURITY: More secure for public desktop apps - no secret to leak!
- SIMPLIFIED: Users only need TWITCH_CLIENT_ID environment variable
- REMOVED: getClientSecret() method and all Client Secret references
- REMOVED: exchangeCodeForToken() and onTokenReplyFinished() methods
- UPDATED: All documentation (SETUP.md, README.md) to reflect Implicit Grant
- UPDATED: run-twitchmod.sh launcher script to only check Client ID
- Files modified:
  - src/twitch/twitchauth.h/cpp - Complete OAuth rewrite
  - src/twitch/oauthserver.cpp - Added JavaScript token extractor page
  - SETUP.md - Removed all Client Secret instructions
  - README.md - Updated quick start guide
  - run-twitchmod.sh - Simplified to only check Client ID
  - changelog.txt - This entry

[2025-11-02 01:44] Fixed OAuth "invalid client" error
------------------------------------------------------
- FIXED: "status":400,"message":"invalid client" error when creating predictions/polls
- ADDED: Environment variable support for OAuth credentials (TWITCH_CLIENT_ID, TWITCH_CLIENT_SECRET)
- CHANGED: Removed hardcoded placeholder credentials from source code
- SECURITY: OAuth credentials now read from environment variables instead of being hardcoded
- ADDED: Created comprehensive SETUP.md with step-by-step instructions
- UPDATED: README.md with quick start guide for environment variable configuration
- IMPROVED: Better error messages when OAuth credentials are not configured
- Files modified:
  - src/twitch/twitchauth.h - Changed from static constexpr to static methods
  - src/twitch/twitchauth.cpp - Added getClientId(), getClientSecret(), getRedirectUri()
  - src/mainwindow.cpp - Updated to use TwitchAuth::getClientId()
  - SETUP.md - New comprehensive setup guide
  - README.md - Updated with environment variable instructions
  - changelog.txt - Created changelog

[2025-11-02 00:00] Initial Release - TwitchMod v1.0.0
-----------------------------------------------------
- ADDED: Professional Twitch moderator client with mIRC-style interface
- ADDED: Qt6 C++ cross-platform implementation (Windows/macOS)
- ADDED: OAuth 2.0 authentication with local callback server
- ADDED: Twitch REST API integration for all moderator actions
- ADDED: Predictions dialog with 2-10 outcomes, validation, duration control
- ADDED: Polls dialog with 2-5 choices, Channel Points voting option
- ADDED: Three-panel mIRC-style layout (channels, chat, users)
- ADDED: User list with mod/VIP badges and context menu
- ADDED: Channel list with "Moderating" and "Watching" categories
- ADDED: Chat widget with Twitch-style dark theme
- ADDED: CMake build system with Windows/macOS support
- ADDED: GitHub Actions workflow for automated builds
- ADDED: Build scripts for both platforms
- ADDED: Comprehensive README with build instructions
- OAuth scopes: All moderator, chat, AutoMod, predictions, polls scopes
- Files created:
  - src/main.cpp, mainwindow.cpp/h
  - src/chatwidget.cpp/h, channellist.cpp/h, userlist.cpp/h
  - src/predictiondialog.cpp/h, polldialog.cpp/h
  - src/twitch/twitchauth.cpp/h, twitchapi.cpp/h, twitchwebsocket.cpp/h
  - src/twitch/oauthserver.cpp/h
  - CMakeLists.txt
  - build-scripts/build-macos.sh, build-windows.bat
  - .github/workflows/build.yml
  - README.md
